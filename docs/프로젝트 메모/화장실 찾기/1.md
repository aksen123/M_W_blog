---
title: 화장실api 조회 방식 변경
---

:::tip 💡
화장실 찾기 페이지를 만들면서 처음엔 드래그가 끝나거나 줌 레벨이 바뀔 때 마다 api를 호출해 해당 지도 범위 내의 화장실을 표시 하는 방법으로 만들었다.
만들고 나서 생각해보니 지도가 움직일때마다 계속 api를 호출하게 된다면, 서버에 과부하가 걸릴수도 있고 속도나 성능에 문제가 있을수 있겠단 생각이 들어 호출하는 방식을 변경하기로 했다.

:::


## 기존 조회 방식

> 지도 레벨이 변경되거나 드래그가 끝날때 마다 api를 호출해 해당 지도범위의 화장실을 표시 해줌 <br />
> `Map`컴포넌트에 onDragEnd,onZoomChanged 이벤트를 주고 지도가 바뀔때 마다 범위 안의 화장실을 찾는 함수를 넣어 줌




## 변경 방식

> 지도 레벨이 변경되거나 드래그가 끝나면 `현위치에서 검색`이라는 버튼을 만들고 버튼을 클릭하면 api를 호출하고 해당 지도 범위 안의 화장실을 찾아서 표시해주는 방식으로 변경
> `Map`컴포넌트에 onDragEnd,onZoomChanged 이벤트를 주고 검색 버튼을 보여주는 함수를 추가해서 지도가 바뀔때 마다 검색버튼을 보여지게 만들었다.


|기존|변경|
|:-----:|:-----:|
|![iPhone-12-PRO-localhost-TA-YH0ezCh](https://github.com/user-attachments/assets/ec55163e-ba06-4597-a981-887617420356)|![iPhone-12-PRO-localhost-CoZ5Kx5rqZ](https://github.com/user-attachments/assets/db5b3c9b-3e89-42e4-976a-3fd0e332bf4b)|

<br />
<br />



이런식으로 변경 했다!!
지금이야 mariadb를 써보겠다고 내 pc에 서버를 두고 만들고 있다지만.
나중에 배포를 하고나서 클라우드 데이터베이스를 사용한다고 하면 위에서 말한 문제도 있지만 비용적인 문제도 있기 때문에 조회하는 방식을 이렇게 변경 했다.

좀더 추가 적으로 수정 해야할게 있긴 한데 지도 레벨이 큰레벨에서 작은 레벨로 돌아올때는(확대할 때) api를 호출 하지 않아도 될것 같은데 이건도 같이 추가 적으로 수정해야 한다.(검색버튼 안보이게)
아무튼 api호출을 최소한으로할 수있는 방식을 좀더 생각해 봐야겠다.
